Make name resolution be a method of AST and Type by making it parametric.
Fix the tests.